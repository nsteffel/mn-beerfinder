<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="UTF-8">
    <title>Minnbeers — Search Nearby</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href='http://fonts.googleapis.com/css?family=Poiret+One|PT+Serif|Open+Sans:400,300' 
          rel='stylesheet' type='text/css'>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="css/socialicons.css" rel="stylesheet">
    <link href="css/glyphicons.css" rel="stylesheet">
    <link href="css/halflings.css" rel="stylesheet">
    <link href="css/template.css" rel="stylesheet">
    <link href="css/colors/color-blue.css" rel="stylesheet" id="colorcss">

    <script src="js/modernizr.js"></script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->
    
   
    <link rel="stylesheet" href="css/jPages.css">
    <link rel="stylesheet" href="css/animate.css">
    
</head>
<body>

<div class="container">
<div class="masthead clearfix">

<!-- The Logo -->
<a href="index.html"><img id="logo" src="img/wwlogo@2x.png" height="63" width="324" alt="Wise Words"></a>

<!-- The Navigation -->
<ul id="nav" class="nav ww-nav pull-right hidden-phone">
  <li><a href="index.html">Home</a></li>
  <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Find Beer</a>
    <ul class="dropdown-menu">
        <li><a href="find_detect.html">Search Nearby</a></li>
        <li><a href="find_lookup.html">Search by Address</a></li>
        <li><a href="#">Search by Area</a></li>
        <li><a href="#">View Full List</a></li>
    </ul>                   
  </li>
  <li><a href="#">About</a></li>
  <li><a href="#">Contact</a></li>
</ul>
</div>

<hr>

<div class="row main-content">
    <div class="offset3 span6 zone-content">
        <article>
<div>
  <form action="">
    Address: <input type="text" id="address" />
    <a href="#" class="button-link" id="address_search" onclick="getCoords();">Search</a>
  </form>
</div>

        <ul id="locations">
          <li id="brew_612brew" data-latlon="44.999061,-93.246496"><a href="612.html">612Brew</a></li>
          <li id="brew_bent" data-latlon="45.024508,-93.173879"><a href="bent.html">Bent Brewstillery</a></li>
          <li id="brew_badgerhill" data-latlon="44.793771,-93.461127"><a href="badgerhill.html">Badger Hill Brewery</a></li>
          <li id="brew_bank" data-latlon="44.5081422,-96.4257009"><a href="bank.html">Bank Brewery</a></li>
          <li id="brew_bang" data-latlon="44.97048,-93.192588"><a href="bang.html">Bang Brewing</a></li>
          <li id="brew_barley" data-latlon="45.036172,-93.198163"><a href="barleyjohns.html">Barley John's</a></li>
          <li id="brew_bauhaus" data-latlon="45.00079,-93.244636"><a href="bauhaus.html">Bauhaus Brew Labs</a></li>
          <li id="brew_beaver" data-latlon="45.5584259,-94.1573335"><a href="beaverisland.html">Beaver Island Brewing</a></li>
          <li id="brew_bemidji" data-latlon="47.471782,-94.881616"><a href="bemidji.html">Bemidji Brewing Company</a></li>
          <li id="brew_bentpaddle" data-latlon="46.76764,-92.121874"><a href="bentpaddle.html">Bent Paddle Brewing</a></li>
          <li id="brew_bigwood" data-latlon="45.085124,-93.006747"><a href="bigwood.html">Big Wood Brewery</a></li>
          <li id="brew_boathouse" data-latlon="47.903474,-91.865653"><a href="boathouse.html">Boathouse Brewpub</a></li>
          <li id="brew_boomisland" data-latlon="44.999866,-93.281473"><a href="boomisland.html">Boom Island Brewing</a></li>
          <li id="brew_braubrothers" data-latlon="44.436527,-95.776115"><a href="braubrothers.html">Brau Brothers</a></li>
          <li id="brew_burningbrothers" data-latlon="44.958809,-93.174271"><a href="burningbrothers.html">Burning Brothers</a></li>
          <li id="brew_canalpark" data-latlon="46.7885185,-92.0932986"><a href="canalpark.html">Canal Park Brewing</a></li>
          <li id="brew_castledanger" data-latlon="47.019558,-91.67343"><a href="castledanger.html">Castle Danger Brewery</a></li>
          <li id="brew_carmody" data-latlon="46.792397,-92.090552"><a href="carmody.html">Carmody Irish Pub</a></li>
          <li id="brew_dangerousman" data-latlon="45.0011,-93.26638"><a href="dangerousman.html">Dangerous Man</a></li>
          <li id="brew_dayblock" data-latlon="44.975189,-93.253061"><a href="dayblock.html">Day Block Brewing</a></li>
          <li id="brew_dubhlinn" data-latlon="46.7906635,-92.0932557"><a href="dubhlinn.html">Dubh Linn</a></li>
          <li id="brew_enki" data-latlon="44.859803,-93.661568"><a href="enki.html">ENKI Brewing</a></li>
          <li id="brew_excelsior" data-latlon="44.902297,-93.566596"><a href="excelsior.html">Excelsior Brewing</a></li>
          <li id="brew_fairstate" data-latlon="45.013559,-93.247873"><a href="fairstate.html">Fair State</a></li>
          <li id="brew_fitgers" data-latlon="46.792397,-92.090552"><a href="fitgers.html">Fitger's Brewhouse</a></li>
          <li id="brew_flatearth" data-latlon="44.962765,-93.071573"><a href="flatearth.html">Flat Earth</a></li>
          <li id="brew_freehouse" data-latlon="44.987388,-93.277242"><a href="freehouse.html">The Freehouse</a></li>
          <li id="brew_fulton" data-latlon="44.98488,-93.279116"><a href="fulton.html">Fulton Beer</a></li>
          <li id="brew_greatwaters" data-latlon="44.946678,-93.096886"><a href="greatwaters.html">Great Waters</a></li>
          <li id="brew_gulldam" data-latlon="46.497603,-94.296858"><a href="gulldam.html">Gull Dam Brewery</a></li>
          <li id="brew_hammerheart" data-latlon="45.188805,-93.107281"><a href="hammerheart.html">HammerHeart</a></li>
          <li id="brew_harriet" data-latlon="44.94712,-93.233872"><a href="harriet.html">Harriet Brewing</a></li>
          <li id="brew_hayes" data-latlon="45.170919,-93.874228"><a href="hayes.html">Hayes Public House</a></li>
          <li id="brew_herkimer" data-latlon="44.949224,-93.288285"><a href="herkimer.html">Herkimer Pub and Brewery</a></li>
          <li id="brew_indeed" data-latlon="45.003464,-93.251547"><a href="indeed.html">Indeed Brewing</a></li>
          <li id="brew_insight" data-latlon="44.991922,-93.212967"><a href="insight.html">Insight Brewing</a></li>
          <li id="brew_jackpine" data-latlon="46.345263,-94.235198"><a href="jackpine.html">Jack Pine</a></li>
          <li id="brew_junkyard" data-latlon="46.876384,-96.756501"><a href="junkyard.html">Junkyard Brewing</a></li>
          <li id="brew_kinney" data-latlon="44.031057,-92.478191"><a href="kinneycreek.html">Kinney Creek</a></li>
          <li id="brew_lakesuperior" data-latlon="46.761083,-92.133364"><a href="lakesuperior.html">Lake Superior Brewing</a></li>
          <li id="brew_liftbridge" data-latlon="45.039177,-92.831797"><a href="liftbridge.html">Lift Bridge Brewing</a></li>
          <li id="brew_ltd" data-latlon="44.924746,-93.40992"><a href="ltd.html">LTD Brewing</a></li>
          <li id="brew_lucid" data-latlon="44.895228,-93.449625"><a href="lucid.html">Lucid Brewing</a></li>
          <li id="brew_lynlake" data-latlon="44.949315,-93.2893129"><a href="lynlake.html">LynLake Brewery</a></li>
          <li id="brew_mankato" data-latlon="44.181367,-94.013933"><a href="mankato.html">Mankato Brewery</a></li>
          <li id="brew_northbound" data-latlon="44.934237,-93.232442"><a href="northbound.html">Northbound Smokehouse and Brewpub</a></li>
          <li id="brew_northgate" data-latlon="44.998192,-93.221183"><a href="northgate.html">Northgate Brewing</a></li>
          <li id="brew_reads" data-latlon="44.402709,-92.078812">Reads Landing Brewing Company</li>
          <li id="brew_redwing" data-latlon="44.562692,-92.547319">Redwing Brewery</li>
          <li id="brew_sisyphus" data-latlon="44.973223,-93.288925">Sisyphus Brewing</li>
          <li id="brew_sociable" data-latlon="45.004516,-93.24415">Sociable Cider Werks</li>
          <li id="brew_steeltoe" data-latlon="44.9413,-93.34124">Steel Toe</li>
          <li id="brew_summit" data-latlon="44.914066,-93.139609">Summit Beer</li>
          <li id="brew_surly" data-latlon="44.973256,-93.209813">Surly Brewing</li>
          <li id="brew_thirdstreet" data-latlon="45.458898,-94.429468">Third Street Brewhouse</li>
          <li id="brew_tinwhiskers" data-latlon="44.950868,-93.093479">Tin Whiskers Brewing</li>
          <li id="brew_townhall" data-latlon="44.97342,-93.247851">Town Hall Brewing</li>
          <li id="brew_townhalllanes" data-latlon="44.911828,-93.222471">Town Hall Lanes</li>
          <li id="brew_townhalltap" data-latlon="44.915757,-93.262879">Town Hall Tap</li>
          <li id="brew_urbangrowler" data-latlon="44.970151,-93.192859">Urban Growler</li>
          <li id="brew_waconia" data-latlon="44.8431091,-93.7954974">Waconia Brewing</li>
          Wabasha
        </ul>
        </article>
    </div>
</div>

<script src="js/jquery-1.9.1.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/tinynav.js"></script>
    <script src="js/template.js"></script>

    <script src="js/latlon.js"></script>
    <script src="js/jquery.quick.pagination.min.js"></script>
    
  <script src="http://maps.google.com/maps/api/js?sensor=set_to_true_or_false"></script>
  <script>
    window.onload = function() {
    $("#locations").hide();
  }
  
  $("#address").keyup(function(event){
    if(event.keyCode == 13){
        $("#address_search").click();
    }
  });

  function getCoords(){
  var geocoder = new google.maps.Geocoder();
  var address = document.getElementById("address").value;
  
  geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK)
  {
  var lat_input = results[0].geometry.location.k;
  var lon_input = results[0].geometry.location.D;  
  }
  var latlon = new LatLon(lat_input,lon_input);
	
    var locations = document.getElementById('locations');
    var locationList = locations.querySelectorAll('li');
    var locationArray = Array.prototype.slice.call(locationList, 0);
    var distanceArray = [];
 
    locationArray.sort(function(a,b){
      var locA  = a.getAttribute('data-latlon').split(',');
      var locB  = b.getAttribute('data-latlon').split(',');
 
      distA = latlon.distanceTo(new LatLon(Number(locA[0]),Number(locA[1])));
      distB = latlon.distanceTo(new LatLon(Number(locB[0]),Number(locB[1])));
      var distance = distA - distB;
      return distance;
      console.log(distance);
    });
    
    locations.innerHTML = "";
    locationArray.forEach(function(el) {
      locations.appendChild(el);
    });
     $("#locations").quickPagination({pageSize:"4"});;
     $("#locations").show();
     
  });
  }
</script>

    <script>
  window.onload = function() {
    $("#locations").hide();
    navigator.geolocation.getCurrentPosition(sortResults);
  }
  
    function sortResults(position) {
    // Grab current position
    //Actual use var latlon = new LatLon(position.coords.latitude, position.coords.longitude);
	//Hotwire it for home
	var latlon = new LatLon(45.0004375, -93.2535929);
	
    var locations = document.getElementById('locations');
    var locationList = locations.querySelectorAll('li');
    var locationArray = Array.prototype.slice.call(locationList, 0);
    var distanceArray = [];
 
    locationArray.sort(function(a,b){
      var locA  = a.getAttribute('data-latlon').split(',');
      var locB  = b.getAttribute('data-latlon').split(',');
 
      distA = latlon.distanceTo(new LatLon(Number(locA[0]),Number(locA[1])));
      distB = latlon.distanceTo(new LatLon(Number(locB[0]),Number(locB[1])));
      var distance = distA - distB;
      return distance;
    });
 
</body>
</html>